

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;


CREATE EXTENSION IF NOT EXISTS "pgsodium";






COMMENT ON SCHEMA "public" IS 'standard public schema';



CREATE EXTENSION IF NOT EXISTS "pg_graphql" WITH SCHEMA "graphql";






CREATE EXTENSION IF NOT EXISTS "pg_stat_statements" WITH SCHEMA "extensions";






CREATE EXTENSION IF NOT EXISTS "pgcrypto" WITH SCHEMA "extensions";






CREATE EXTENSION IF NOT EXISTS "pgjwt" WITH SCHEMA "extensions";






CREATE EXTENSION IF NOT EXISTS "supabase_vault" WITH SCHEMA "vault";






CREATE EXTENSION IF NOT EXISTS "uuid-ossp" WITH SCHEMA "extensions";






CREATE OR REPLACE FUNCTION "public"."update_updated_at_column"() RETURNS "trigger"
    LANGUAGE "plpgsql"
    AS $$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$$;


ALTER FUNCTION "public"."update_updated_at_column"() OWNER TO "postgres";

SET default_tablespace = '';

SET default_table_access_method = "heap";


CREATE TABLE IF NOT EXISTS "public"."cargo" (
    "id" integer NOT NULL,
    "nome" character varying(100) NOT NULL,
    "ativo" boolean DEFAULT true,
    "created_at" timestamp with time zone DEFAULT "now"()
);


ALTER TABLE "public"."cargo" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."cargo_id_seq"
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE "public"."cargo_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."cargo_id_seq" OWNED BY "public"."cargo"."id";



CREATE TABLE IF NOT EXISTS "public"."controle" (
    "id" bigint NOT NULL,
    "numero" bigint,
    "diagnostico" bigint,
    "nome" "text"
);


ALTER TABLE "public"."controle" OWNER TO "postgres";


COMMENT ON TABLE "public"."controle" IS 'Controles';



ALTER TABLE "public"."controle" ALTER COLUMN "id" ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME "public"."controle_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);



CREATE TABLE IF NOT EXISTS "public"."departamento" (
    "id" integer NOT NULL,
    "nome" character varying(100) NOT NULL,
    "ativo" boolean DEFAULT true,
    "created_at" timestamp with time zone DEFAULT "now"()
);


ALTER TABLE "public"."departamento" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."departamento_id_seq"
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE "public"."departamento_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."departamento_id_seq" OWNED BY "public"."departamento"."id";



CREATE TABLE IF NOT EXISTS "public"."diagnostico" (
    "id" bigint NOT NULL,
    "descricao" "text",
    "cor" "text",
    "indice" "text",
    "maturidade" bigint
);


ALTER TABLE "public"."diagnostico" OWNER TO "postgres";


COMMENT ON TABLE "public"."diagnostico" IS 'Categoria Diagnóstico';



ALTER TABLE "public"."diagnostico" ALTER COLUMN "id" ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME "public"."diagnostico_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);



CREATE TABLE IF NOT EXISTS "public"."medida" (
    "id" bigint NOT NULL,
    "id_medida" "text",
    "id_controle" bigint,
    "id_cisv8" "text",
    "grupo_imple" "text",
    "funcao_nist_csf" "text",
    "medida" "text",
    "descricao" "text"
);


ALTER TABLE "public"."medida" OWNER TO "postgres";


COMMENT ON TABLE "public"."medida" IS 'Medidas';



CREATE TABLE IF NOT EXISTS "public"."programa_medida" (
    "id" integer NOT NULL,
    "programa" integer,
    "resposta" "text",
    "justificativa" "text",
    "medida" integer,
    "observacao_orgao" "text",
    "responsavel" integer,
    "previsao_inicio" "date",
    "previsao_fim" "date",
    "status_medida" integer,
    "nova_resposta" "text",
    "encaminhamento_interno" "text",
    "controle" bigint,
    "status_plano_acao" integer
);


ALTER TABLE "public"."programa_medida" OWNER TO "postgres";


COMMENT ON TABLE "public"."programa_medida" IS 'Cadastro de Medidas';



ALTER TABLE "public"."programa_medida" ALTER COLUMN "id" ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME "public"."medida_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);



ALTER TABLE "public"."medida" ALTER COLUMN "id" ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME "public"."medida_id_seq1"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);



CREATE TABLE IF NOT EXISTS "public"."orgao" (
    "id" integer NOT NULL,
    "nome" "text",
    "cnpj" numeric
);


ALTER TABLE "public"."orgao" OWNER TO "postgres";


COMMENT ON TABLE "public"."orgao" IS 'Órgãos';



ALTER TABLE "public"."orgao" ALTER COLUMN "id" ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME "public"."orgao_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);



CREATE TABLE IF NOT EXISTS "public"."profiles" (
    "user_id" "uuid" NOT NULL,
    "nome" character varying(255),
    "email" character varying(255),
    "telefone" character varying(50),
    "cargo_id" integer,
    "departamento_id" integer,
    "avatar_url" "text",
    "verified" boolean DEFAULT false,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"()
);


ALTER TABLE "public"."profiles" OWNER TO "postgres";


CREATE TABLE IF NOT EXISTS "public"."programa" (
    "id" integer NOT NULL,
    "criado_em" time without time zone DEFAULT "now"(),
    "orgao" integer,
    "responsavel_controle_interno" integer,
    "responsavel_si" integer,
    "responsavel_privacidade" integer,
    "responsavel_ti" integer,
    "sgd_numero_documento_nota_tecnica" "text",
    "sgd_versao_diagnostico_enviado" "text",
    "sgd_data_limite_retorno" "date",
    "sgd_retorno_data" "date",
    "sgd_versao_diagnostico" "text",
    "cnpj" numeric,
    "razao_social" "text",
    "setor" smallint,
    "atendimento_fone" "text",
    "atendimento_email" "text",
    "atendimento_site" "text",
    "politica_inicio_vigencia" "date",
    "politica_prazo_revisao" "date",
    "nome_fantasia" "text"
);


ALTER TABLE "public"."programa" OWNER TO "postgres";


COMMENT ON TABLE "public"."programa" IS 'Cadastros de Programa e Responsáveis';



CREATE TABLE IF NOT EXISTS "public"."programa_controle" (
    "id" bigint NOT NULL,
    "controle" bigint NOT NULL,
    "programa" integer NOT NULL,
    "nivel" integer
);


ALTER TABLE "public"."programa_controle" OWNER TO "postgres";


ALTER TABLE "public"."programa_controle" ALTER COLUMN "id" ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME "public"."programa_controle_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);



ALTER TABLE "public"."programa" ALTER COLUMN "id" ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME "public"."programa_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);



CREATE TABLE IF NOT EXISTS "public"."programa_invites" (
    "id" integer NOT NULL,
    "programa_id" integer NOT NULL,
    "email" character varying(255) NOT NULL,
    "role" character varying(50) NOT NULL,
    "permissions" "jsonb" NOT NULL,
    "token" character varying(255) NOT NULL,
    "status" character varying(20) DEFAULT 'pending'::character varying,
    "invited_at" timestamp with time zone DEFAULT "now"(),
    "expires_at" timestamp with time zone NOT NULL,
    "message" "text",
    "invited_by" character varying(255),
    "accepted_at" timestamp with time zone,
    "declined_at" timestamp with time zone,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"()
);


ALTER TABLE "public"."programa_invites" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."programa_invites_id_seq"
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE "public"."programa_invites_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."programa_invites_id_seq" OWNED BY "public"."programa_invites"."id";



CREATE TABLE IF NOT EXISTS "public"."programa_users" (
    "id" integer NOT NULL,
    "programa_id" integer NOT NULL,
    "user_id" character varying(255) NOT NULL,
    "role" character varying(50) DEFAULT 'analista'::character varying NOT NULL,
    "permissions" "jsonb" NOT NULL,
    "status" character varying(20) DEFAULT 'accepted'::character varying NOT NULL,
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"(),
    "invited_by" character varying(255),
    "invited_at" timestamp with time zone,
    "accepted_at" timestamp with time zone
);


ALTER TABLE "public"."programa_users" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."programa_users_id_seq"
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE "public"."programa_users_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."programa_users_id_seq" OWNED BY "public"."programa_users"."id";



CREATE TABLE IF NOT EXISTS "public"."responsavel" (
    "id" integer NOT NULL,
    "programa" integer NOT NULL,
    "nome" "text" NOT NULL,
    "departamento" "text" NOT NULL,
    "email" "text"
);


ALTER TABLE "public"."responsavel" OWNER TO "postgres";


COMMENT ON TABLE "public"."responsavel" IS 'Cadastro de Responsáveis';



ALTER TABLE "public"."responsavel" ALTER COLUMN "id" ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME "public"."responsavel_id_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);



CREATE TABLE IF NOT EXISTS "public"."ropa" (
    "id" integer NOT NULL,
    "programa_id" integer NOT NULL,
    "nome" character varying(500) NOT NULL,
    "finalidade" "text",
    "base_legal" character varying(100),
    "categorias_dados" "text",
    "categorias_titulares" "text",
    "compartilhamento" "text",
    "retencao" "text",
    "medidas_seguranca" "text",
    "responsavel" character varying(255),
    "created_at" timestamp with time zone DEFAULT "now"(),
    "updated_at" timestamp with time zone DEFAULT "now"()
);


ALTER TABLE "public"."ropa" OWNER TO "postgres";


COMMENT ON TABLE "public"."ropa" IS 'Registro das Operações de Tratamento (ROPA) - Art. 37 LGPD';



COMMENT ON COLUMN "public"."ropa"."nome" IS 'Nome da operação de tratamento';



COMMENT ON COLUMN "public"."ropa"."finalidade" IS 'Finalidade do tratamento';



COMMENT ON COLUMN "public"."ropa"."base_legal" IS 'Base legal (consentimento, contrato, obrigação legal, etc.)';



COMMENT ON COLUMN "public"."ropa"."categorias_dados" IS 'Categorias de dados pessoais tratados';



COMMENT ON COLUMN "public"."ropa"."categorias_titulares" IS 'Categorias de titulares';



COMMENT ON COLUMN "public"."ropa"."compartilhamento" IS 'Compartilhamento (com quem e para que)';



COMMENT ON COLUMN "public"."ropa"."retencao" IS 'Prazo/critério de retenção';



COMMENT ON COLUMN "public"."ropa"."medidas_seguranca" IS 'Medidas de segurança e técnicas';



CREATE SEQUENCE IF NOT EXISTS "public"."ropa_id_seq"
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE "public"."ropa_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."ropa_id_seq" OWNED BY "public"."ropa"."id";



CREATE TABLE IF NOT EXISTS "public"."user_activities" (
    "id" integer NOT NULL,
    "user_id" character varying(255) NOT NULL,
    "programa_id" integer NOT NULL,
    "action" character varying(50) NOT NULL,
    "resource_type" character varying(50),
    "resource_id" integer,
    "details" "jsonb",
    "ip_address" "inet",
    "user_agent" "text",
    "created_at" timestamp with time zone DEFAULT "now"(),
    CONSTRAINT "user_activities_action_check" CHECK ((("action")::"text" = ANY ((ARRAY['create'::character varying, 'update'::character varying, 'delete'::character varying, 'view'::character varying, 'approve'::character varying, 'reject'::character varying, 'invite'::character varying, 'login'::character varying, 'logout'::character varying])::"text"[])))
);


ALTER TABLE "public"."user_activities" OWNER TO "postgres";


CREATE SEQUENCE IF NOT EXISTS "public"."user_activities_id_seq"
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE "public"."user_activities_id_seq" OWNER TO "postgres";


ALTER SEQUENCE "public"."user_activities_id_seq" OWNED BY "public"."user_activities"."id";



ALTER TABLE ONLY "public"."cargo" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."cargo_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."departamento" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."departamento_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."programa_invites" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."programa_invites_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."programa_users" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."programa_users_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."ropa" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."ropa_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."user_activities" ALTER COLUMN "id" SET DEFAULT "nextval"('"public"."user_activities_id_seq"'::"regclass");



ALTER TABLE ONLY "public"."cargo"
    ADD CONSTRAINT "cargo_nome_key" UNIQUE ("nome");



ALTER TABLE ONLY "public"."cargo"
    ADD CONSTRAINT "cargo_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."controle"
    ADD CONSTRAINT "controle_id_key" UNIQUE ("id");



ALTER TABLE ONLY "public"."controle"
    ADD CONSTRAINT "controle_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."departamento"
    ADD CONSTRAINT "departamento_nome_key" UNIQUE ("nome");



ALTER TABLE ONLY "public"."departamento"
    ADD CONSTRAINT "departamento_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."diagnostico"
    ADD CONSTRAINT "diagnostico_id_key" UNIQUE ("id");



ALTER TABLE ONLY "public"."diagnostico"
    ADD CONSTRAINT "diagnostico_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."programa_medida"
    ADD CONSTRAINT "medida_id_key" UNIQUE ("id");



ALTER TABLE ONLY "public"."medida"
    ADD CONSTRAINT "medida_id_key1" UNIQUE ("id");



ALTER TABLE ONLY "public"."programa_medida"
    ADD CONSTRAINT "medida_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."medida"
    ADD CONSTRAINT "medida_pkey1" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."orgao"
    ADD CONSTRAINT "orgao_id_key" UNIQUE ("id");



ALTER TABLE ONLY "public"."orgao"
    ADD CONSTRAINT "orgao_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."profiles"
    ADD CONSTRAINT "profiles_pkey" PRIMARY KEY ("user_id");



ALTER TABLE ONLY "public"."programa_controle"
    ADD CONSTRAINT "programa_controle_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."programa"
    ADD CONSTRAINT "programa_id_key" UNIQUE ("id");



ALTER TABLE ONLY "public"."programa_invites"
    ADD CONSTRAINT "programa_invites_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."programa_invites"
    ADD CONSTRAINT "programa_invites_token_key" UNIQUE ("token");



ALTER TABLE ONLY "public"."programa"
    ADD CONSTRAINT "programa_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."programa_users"
    ADD CONSTRAINT "programa_users_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."programa_users"
    ADD CONSTRAINT "programa_users_programa_id_user_id_key" UNIQUE ("programa_id", "user_id");



ALTER TABLE ONLY "public"."responsavel"
    ADD CONSTRAINT "responsavel_id_key" UNIQUE ("id");



ALTER TABLE ONLY "public"."responsavel"
    ADD CONSTRAINT "responsavel_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."ropa"
    ADD CONSTRAINT "ropa_pkey" PRIMARY KEY ("id");



ALTER TABLE ONLY "public"."programa_medida"
    ADD CONSTRAINT "unique_programa_medida" UNIQUE ("programa", "medida");



ALTER TABLE ONLY "public"."user_activities"
    ADD CONSTRAINT "user_activities_pkey" PRIMARY KEY ("id");



CREATE INDEX "idx_cargo_ativo" ON "public"."cargo" USING "btree" ("ativo");



CREATE INDEX "idx_cargo_nome" ON "public"."cargo" USING "btree" ("nome");



CREATE INDEX "idx_departamento_ativo" ON "public"."departamento" USING "btree" ("ativo");



CREATE INDEX "idx_departamento_nome" ON "public"."departamento" USING "btree" ("nome");



CREATE INDEX "idx_profiles_email" ON "public"."profiles" USING "btree" ("email");



CREATE INDEX "idx_programa_invites_email" ON "public"."programa_invites" USING "btree" ("email");



CREATE INDEX "idx_programa_invites_expires_at" ON "public"."programa_invites" USING "btree" ("expires_at");



CREATE INDEX "idx_programa_invites_programa_id" ON "public"."programa_invites" USING "btree" ("programa_id");



CREATE INDEX "idx_programa_invites_status" ON "public"."programa_invites" USING "btree" ("status");



CREATE INDEX "idx_programa_invites_token" ON "public"."programa_invites" USING "btree" ("token");



CREATE INDEX "idx_programa_users_programa_id" ON "public"."programa_users" USING "btree" ("programa_id");



CREATE INDEX "idx_programa_users_role" ON "public"."programa_users" USING "btree" ("role");



CREATE INDEX "idx_programa_users_status" ON "public"."programa_users" USING "btree" ("status");



CREATE INDEX "idx_programa_users_user_id" ON "public"."programa_users" USING "btree" ("user_id");



CREATE INDEX "idx_ropa_programa_id" ON "public"."ropa" USING "btree" ("programa_id");



CREATE INDEX "idx_user_activities_created_at" ON "public"."user_activities" USING "btree" ("created_at");



CREATE INDEX "idx_user_activities_programa_id" ON "public"."user_activities" USING "btree" ("programa_id");



CREATE INDEX "idx_user_activities_user_id" ON "public"."user_activities" USING "btree" ("user_id");



CREATE OR REPLACE TRIGGER "update_programa_invites_updated_at" BEFORE UPDATE ON "public"."programa_invites" FOR EACH ROW EXECUTE FUNCTION "public"."update_updated_at_column"();



CREATE OR REPLACE TRIGGER "update_programa_users_updated_at" BEFORE UPDATE ON "public"."programa_users" FOR EACH ROW EXECUTE FUNCTION "public"."update_updated_at_column"();



CREATE OR REPLACE TRIGGER "update_ropa_updated_at" BEFORE UPDATE ON "public"."ropa" FOR EACH ROW EXECUTE FUNCTION "public"."update_updated_at_column"();



ALTER TABLE ONLY "public"."controle"
    ADD CONSTRAINT "controle_diagnostico_fkey" FOREIGN KEY ("diagnostico") REFERENCES "public"."diagnostico"("id");



ALTER TABLE ONLY "public"."medida"
    ADD CONSTRAINT "medida_id_controle_fkey" FOREIGN KEY ("id_controle") REFERENCES "public"."controle"("id");



ALTER TABLE ONLY "public"."programa_medida"
    ADD CONSTRAINT "medida_programa_fkey" FOREIGN KEY ("programa") REFERENCES "public"."programa"("id") ON UPDATE CASCADE ON DELETE CASCADE;



ALTER TABLE ONLY "public"."profiles"
    ADD CONSTRAINT "profiles_cargo_id_fkey" FOREIGN KEY ("cargo_id") REFERENCES "public"."cargo"("id");



ALTER TABLE ONLY "public"."profiles"
    ADD CONSTRAINT "profiles_departamento_id_fkey" FOREIGN KEY ("departamento_id") REFERENCES "public"."departamento"("id");



ALTER TABLE ONLY "public"."profiles"
    ADD CONSTRAINT "profiles_user_id_fkey" FOREIGN KEY ("user_id") REFERENCES "auth"."users"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."programa_controle"
    ADD CONSTRAINT "programa_controle_controle_fkey" FOREIGN KEY ("controle") REFERENCES "public"."controle"("id");



ALTER TABLE ONLY "public"."programa_controle"
    ADD CONSTRAINT "programa_controle_programa_fkey" FOREIGN KEY ("programa") REFERENCES "public"."programa"("id");



ALTER TABLE ONLY "public"."programa_invites"
    ADD CONSTRAINT "programa_invites_programa_id_fkey" FOREIGN KEY ("programa_id") REFERENCES "public"."programa"("id");



ALTER TABLE ONLY "public"."programa_medida"
    ADD CONSTRAINT "programa_medida_controle_fkey" FOREIGN KEY ("controle") REFERENCES "public"."controle"("id");



ALTER TABLE ONLY "public"."programa_medida"
    ADD CONSTRAINT "programa_medida_medida_fkey" FOREIGN KEY ("medida") REFERENCES "public"."medida"("id");



ALTER TABLE ONLY "public"."programa"
    ADD CONSTRAINT "programa_orgao_fkey" FOREIGN KEY ("orgao") REFERENCES "public"."orgao"("id");



ALTER TABLE ONLY "public"."programa"
    ADD CONSTRAINT "programa_responsavel_controle_interno_fkey" FOREIGN KEY ("responsavel_controle_interno") REFERENCES "public"."responsavel"("id");



ALTER TABLE ONLY "public"."programa"
    ADD CONSTRAINT "programa_responsavel_privacidade_fkey" FOREIGN KEY ("responsavel_privacidade") REFERENCES "public"."responsavel"("id");



ALTER TABLE ONLY "public"."programa"
    ADD CONSTRAINT "programa_responsavel_si_fkey" FOREIGN KEY ("responsavel_si") REFERENCES "public"."responsavel"("id");



ALTER TABLE ONLY "public"."programa"
    ADD CONSTRAINT "programa_responsavel_ti_fkey" FOREIGN KEY ("responsavel_ti") REFERENCES "public"."responsavel"("id");



ALTER TABLE ONLY "public"."programa_users"
    ADD CONSTRAINT "programa_users_programa_id_fkey" FOREIGN KEY ("programa_id") REFERENCES "public"."programa"("id");



ALTER TABLE ONLY "public"."responsavel"
    ADD CONSTRAINT "responsavel_programa_fkey" FOREIGN KEY ("programa") REFERENCES "public"."programa"("id") ON UPDATE CASCADE ON DELETE CASCADE;



ALTER TABLE ONLY "public"."ropa"
    ADD CONSTRAINT "ropa_programa_fkey" FOREIGN KEY ("programa_id") REFERENCES "public"."programa"("id") ON DELETE CASCADE;



ALTER TABLE ONLY "public"."user_activities"
    ADD CONSTRAINT "user_activities_programa_fkey" FOREIGN KEY ("programa_id") REFERENCES "public"."programa"("id") ON DELETE CASCADE;



CREATE POLICY "Users can insert own profile" ON "public"."profiles" FOR INSERT WITH CHECK (("auth"."uid"() = "user_id"));



CREATE POLICY "Users can update own profile" ON "public"."profiles" FOR UPDATE USING (("auth"."uid"() = "user_id"));



CREATE POLICY "Users can view own profile" ON "public"."profiles" FOR SELECT USING (("auth"."uid"() = "user_id"));



ALTER TABLE "public"."profiles" ENABLE ROW LEVEL SECURITY;




ALTER PUBLICATION "supabase_realtime" OWNER TO "postgres";


ALTER PUBLICATION "supabase_realtime" ADD TABLE ONLY "public"."controle";



ALTER PUBLICATION "supabase_realtime" ADD TABLE ONLY "public"."medida";



ALTER PUBLICATION "supabase_realtime" ADD TABLE ONLY "public"."programa";



ALTER PUBLICATION "supabase_realtime" ADD TABLE ONLY "public"."programa_controle";



ALTER PUBLICATION "supabase_realtime" ADD TABLE ONLY "public"."programa_medida";



ALTER PUBLICATION "supabase_realtime" ADD TABLE ONLY "public"."responsavel";



GRANT USAGE ON SCHEMA "public" TO "postgres";
GRANT USAGE ON SCHEMA "public" TO "anon";
GRANT USAGE ON SCHEMA "public" TO "authenticated";
GRANT USAGE ON SCHEMA "public" TO "service_role";




















































































































































































GRANT ALL ON FUNCTION "public"."update_updated_at_column"() TO "anon";
GRANT ALL ON FUNCTION "public"."update_updated_at_column"() TO "authenticated";
GRANT ALL ON FUNCTION "public"."update_updated_at_column"() TO "service_role";



























GRANT ALL ON TABLE "public"."cargo" TO "anon";
GRANT ALL ON TABLE "public"."cargo" TO "authenticated";
GRANT ALL ON TABLE "public"."cargo" TO "service_role";



GRANT ALL ON SEQUENCE "public"."cargo_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."cargo_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."cargo_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."controle" TO "anon";
GRANT ALL ON TABLE "public"."controle" TO "authenticated";
GRANT ALL ON TABLE "public"."controle" TO "service_role";



GRANT ALL ON SEQUENCE "public"."controle_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."controle_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."controle_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."departamento" TO "anon";
GRANT ALL ON TABLE "public"."departamento" TO "authenticated";
GRANT ALL ON TABLE "public"."departamento" TO "service_role";



GRANT ALL ON SEQUENCE "public"."departamento_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."departamento_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."departamento_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."diagnostico" TO "anon";
GRANT ALL ON TABLE "public"."diagnostico" TO "authenticated";
GRANT ALL ON TABLE "public"."diagnostico" TO "service_role";



GRANT ALL ON SEQUENCE "public"."diagnostico_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."diagnostico_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."diagnostico_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."medida" TO "anon";
GRANT ALL ON TABLE "public"."medida" TO "authenticated";
GRANT ALL ON TABLE "public"."medida" TO "service_role";



GRANT ALL ON TABLE "public"."programa_medida" TO "anon";
GRANT ALL ON TABLE "public"."programa_medida" TO "authenticated";
GRANT ALL ON TABLE "public"."programa_medida" TO "service_role";



GRANT ALL ON SEQUENCE "public"."medida_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."medida_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."medida_id_seq" TO "service_role";



GRANT ALL ON SEQUENCE "public"."medida_id_seq1" TO "anon";
GRANT ALL ON SEQUENCE "public"."medida_id_seq1" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."medida_id_seq1" TO "service_role";



GRANT ALL ON TABLE "public"."orgao" TO "anon";
GRANT ALL ON TABLE "public"."orgao" TO "authenticated";
GRANT ALL ON TABLE "public"."orgao" TO "service_role";



GRANT ALL ON SEQUENCE "public"."orgao_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."orgao_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."orgao_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."profiles" TO "anon";
GRANT ALL ON TABLE "public"."profiles" TO "authenticated";
GRANT ALL ON TABLE "public"."profiles" TO "service_role";



GRANT ALL ON TABLE "public"."programa" TO "anon";
GRANT ALL ON TABLE "public"."programa" TO "authenticated";
GRANT ALL ON TABLE "public"."programa" TO "service_role";



GRANT ALL ON TABLE "public"."programa_controle" TO "anon";
GRANT ALL ON TABLE "public"."programa_controle" TO "authenticated";
GRANT ALL ON TABLE "public"."programa_controle" TO "service_role";



GRANT ALL ON SEQUENCE "public"."programa_controle_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."programa_controle_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."programa_controle_id_seq" TO "service_role";



GRANT ALL ON SEQUENCE "public"."programa_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."programa_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."programa_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."programa_invites" TO "anon";
GRANT ALL ON TABLE "public"."programa_invites" TO "authenticated";
GRANT ALL ON TABLE "public"."programa_invites" TO "service_role";



GRANT ALL ON SEQUENCE "public"."programa_invites_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."programa_invites_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."programa_invites_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."programa_users" TO "anon";
GRANT ALL ON TABLE "public"."programa_users" TO "authenticated";
GRANT ALL ON TABLE "public"."programa_users" TO "service_role";



GRANT ALL ON SEQUENCE "public"."programa_users_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."programa_users_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."programa_users_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."responsavel" TO "anon";
GRANT ALL ON TABLE "public"."responsavel" TO "authenticated";
GRANT ALL ON TABLE "public"."responsavel" TO "service_role";



GRANT ALL ON SEQUENCE "public"."responsavel_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."responsavel_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."responsavel_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."ropa" TO "anon";
GRANT ALL ON TABLE "public"."ropa" TO "authenticated";
GRANT ALL ON TABLE "public"."ropa" TO "service_role";



GRANT ALL ON SEQUENCE "public"."ropa_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."ropa_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."ropa_id_seq" TO "service_role";



GRANT ALL ON TABLE "public"."user_activities" TO "anon";
GRANT ALL ON TABLE "public"."user_activities" TO "authenticated";
GRANT ALL ON TABLE "public"."user_activities" TO "service_role";



GRANT ALL ON SEQUENCE "public"."user_activities_id_seq" TO "anon";
GRANT ALL ON SEQUENCE "public"."user_activities_id_seq" TO "authenticated";
GRANT ALL ON SEQUENCE "public"."user_activities_id_seq" TO "service_role";









ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON SEQUENCES  TO "postgres";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON SEQUENCES  TO "anon";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON SEQUENCES  TO "authenticated";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON SEQUENCES  TO "service_role";






ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON FUNCTIONS  TO "postgres";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON FUNCTIONS  TO "anon";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON FUNCTIONS  TO "authenticated";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON FUNCTIONS  TO "service_role";






ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON TABLES  TO "postgres";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON TABLES  TO "anon";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON TABLES  TO "authenticated";
ALTER DEFAULT PRIVILEGES FOR ROLE "postgres" IN SCHEMA "public" GRANT ALL ON TABLES  TO "service_role";






























